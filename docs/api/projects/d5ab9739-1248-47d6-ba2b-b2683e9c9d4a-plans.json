{"plans":[{"id":"a4653d26-52e3-4412-89d2-553fc7280df8","project":{"id":"d5ab9739-1248-47d6-ba2b-b2683e9c9d4a","canonical_git_repository":"https://github.com/satetsu888/snake-game"},"description":"2人プレイに対応する","body":"# 2人プレイに対応する\n\n## ゲームルール\n- **ゲームオーバー条件**: どちらかが死んだら即座に終了、スコア比較で勝敗決定\n- **衝突判定**: 相手のスネークの体に頭がぶつかった方のみ死亡\n\n## 操作方法\n- Player 1: WASD\n- Player 2: 矢印キー\n\n## 設計方針\n\n現在の責務分離構造を維持しつつ、2人プレイに対応する。\n\n### 1. Player クラスの新規作成\n各プレイヤーの状態を管理する独立したクラスを作成。\n\n```javascript\nclass Player {\n    constructor(id, startPosition, initialDirection, color) {\n        this.id = id;\n        this.snake = [startPosition];\n        this.direction = initialDirection;\n        this.nextDirection = initialDirection;\n        this.score = 0;\n        this.color = color;\n        this.isAlive = true;\n    }\n}\n```\n\n### 2. GameState の変更\n- `snake`, `direction`, `nextDirection`, `score` を削除\n- `players: Player[]` を追加\n- `gameMode: 'single' | 'versus'` を追加\n- `winner: Player | null` を追加\n\n### 3. SnakeController の変更\n- コンストラクタで対象の `Player` を受け取る\n- `checkCollision(allPlayers)`: 他プレイヤーのスネークとの衝突判定を追加\n\n```javascript\ncheckCollision(allPlayers) {\n    const head = this.player.snake[0];\n    \n    // 壁衝突\n    if (head.x < 0 || head.x >= gridCount || ...) return true;\n    \n    // 自分の体との衝突\n    for (let i = 1; i < this.player.snake.length; i++) { ... }\n    \n    // 他プレイヤーのスネーク全体との衝突\n    for (const other of allPlayers) {\n        if (other.id === this.player.id) continue;\n        for (const segment of other.snake) {\n            if (head.x === segment.x && head.y === segment.y) return true;\n        }\n    }\n    return false;\n}\n```\n\n### 4. FoodController の変更\n- `isOnSnake()`: 全プレイヤーのスネークをチェック\n- `spawn(allPlayers)`: 全スネークを避けて配置\n\n### 5. Renderer の変更\n- `drawSnake(player)`: プレイヤーの色情報を使って描画\n- `drawGameOver()`: 勝者表示を追加\n- Player 1: 緑系（現在の色）\n- Player 2: 青/紫系\n\n### 6. InputHandler の変更\n- 複数の SnakeController を管理\n- キーマッピングを分離\n\n```javascript\nconst KEY_MAPPINGS = {\n    player1: { w: UP, s: DOWN, a: LEFT, d: RIGHT },\n    player2: { ArrowUp: UP, ArrowDown: DOWN, ArrowLeft: LEFT, ArrowRight: RIGHT }\n};\n```\n\n### 7. UI 変更 (index.html / style.css)\n- モード選択ボタンを追加（1P / 2P）\n- 2人用スコアボードレイアウト\n- 操作説明の更新\n\n### 8. Game クラスの変更\n- モード切替対応\n- プレイヤー初期位置の設定\n  - Player 1: 左側 (5, 10) 向き RIGHT\n  - Player 2: 右側 (15, 10) 向き LEFT\n- ゲームループで全プレイヤーを更新\n- 勝敗判定ロジック\n\n## 実装順序\n\n1. `Player` クラスを追加\n2. `GameState` を拡張（後方互換性を維持しつつ）\n3. `SnakeController` を Player 対応に変更\n4. `FoodController` を複数プレイヤー対応に変更\n5. `InputHandler` をキー分離対応に変更\n6. `Renderer` を複数スネーク対応に変更\n7. `Game` クラスでモード切替・勝敗判定を実装\n8. UIの変更（HTML/CSS）\n\n## ファイル構成\n既存の `game.js` 内で対応（ファイル分割は行わない）\n","status":"complete","collaborators":[{"id":"6b079860-e7f9-4ad8-a559-1f53031c0461","display_name":"satetsu888"}],"created_at":"2026-01-05T22:41:03+09:00","updated_at":"2026-01-05T22:49:51+09:00"},{"id":"506945ba-9344-4263-962b-da66af03c0cf","project":{"id":"d5ab9739-1248-47d6-ba2b-b2683e9c9d4a","canonical_git_repository":"https://github.com/satetsu888/snake-game"},"description":"敵キャラを出したい","body":"なんかすごいやつ","status":"scratch","collaborators":[{"id":"6b079860-e7f9-4ad8-a559-1f53031c0461","display_name":"satetsu888"}],"created_at":"2026-01-05T22:40:42+09:00","updated_at":"2026-01-05T22:40:42+09:00"}]}